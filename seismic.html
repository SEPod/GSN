<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Seismic Helper ‚Äì ASCE 7 Chapter 12</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #f5f5f7;
      --card-bg: #ffffff;
      --border: #d0d0d5;
      --accent: #1f6feb;
      --accent-soft: rgba(31, 111, 235, 0.08);
      --text-main: #111827;
      --text-muted: #4b5563;
      --danger: #b91c1c;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 14px 30px rgba(15, 23, 42, 0.08);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e5edff 0, #f5f5f7 55%);
      color: var(--text-main);
    }

    .app {
      max-width: 980px;
      margin: 0 auto;
      padding: 2.5rem 1rem 3rem;
    }

    /* Top navigation shared across tools */
    .top-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
      padding: 0.5rem 0.75rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.03);
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .top-nav a {
      font-size: 0.85rem;
      padding: 0.35rem 0.85rem;
      border-radius: 999px;
      text-decoration: none;
      color: #111827;
      background: #ffffff;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .top-nav a:hover {
      background: #e5edff;
      border-color: #1f6feb;
    }

    .top-nav a.current {
      background: #1f6feb;
      color: #ffffff;
      border-color: #1f6feb;
    }

    header {
      margin-bottom: 1.75rem;
      text-align: left;
    }

    header h1 {
      margin: 0 0 0.35rem;
      font-size: 1.9rem;
      letter-spacing: 0.03em;
    }

    header p {
      margin: 0;
      color: var(--text-muted);
      max-width: 720px;
      font-size: 0.95rem;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      padding: 1.4rem 1.5rem 1.7rem;
      margin-bottom: 1.4rem;
      border: 1px solid rgba(148,163,184,0.3);
    }

    .card h2 {
      margin: 0 0 0.7rem;
      font-size: 1.2rem;
    }

    .sub {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin: 0 0 0.6rem;
    }

    .disclaimer {
      border-left: 4px solid var(--danger);
      background: #fef2f2;
      color: #7f1d1d;
      font-size: 0.9rem;
    }

    .disclaimer strong {
      display: inline-block;
      margin-bottom: 0.25rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 0.6rem 1rem;
      margin-top: 0.4rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .field label {
      margin-bottom: 0.14rem;
      color: var(--text-muted);
    }

    .field input,
    .field select {
      padding: 0.35rem 0.45rem;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      font-size: 0.85rem;
    }

    .field input:focus,
    .field select:focus {
      outline: 2px solid var(--accent);
      outline-offset: 1px;
      background: #ffffff;
    }

    .inline-radio {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      font-size: 0.8rem;
      margin-top: 0.1rem;
      color: var(--text-muted);
    }

    .inline-radio label {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      cursor: pointer;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.65rem;
      margin-top: 0.9rem;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 0.55rem 1.15rem;
      font-size: 0.92rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      white-space: nowrap;
    }

    button.primary {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 10px 18px rgba(31,111,235,0.35);
    }

    button.secondary {
      background: #e5e7eb;
      color: #111827;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    textarea {
      width: 100%;
      min-height: 260px;
      font-family: "SF Mono", ui-monospace, Menlo, Consolas, monospace;
      font-size: 0.86rem;
      line-height: 1.5;
      padding: 0.9rem;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: #0f172a;
      color: #e5e7eb;
      box-shadow: inset 0 0 0 1px rgba(15,23,42,0.8);
      resize: vertical;
    }

    textarea:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .copy-status {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.35rem;
      min-height: 1em;
    }

    .copy-status.success { color: #059669; }
    .copy-status.error { color: var(--danger); }

    footer {
      margin-top: 1rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-align: right;
    }

    @media (max-width: 640px) {
      .app { padding-inline: 0.8rem; }
      header h1 { font-size: 1.6rem; }
      button.primary,
      button.secondary {
        flex: 1 1 auto;
        justify-content: center;
      }
      textarea {
        min-height: 220px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Shared navigation between tools -->
    <nav class="top-nav">
      <a href="index.html">General Notes</a>
      <a href="seismic.html" class="current">Seismic Helper</a>
      <a href="wind.html">Wind Helper</a>
    </nav>

    <header>
      <h1>Seismic Helper ‚Äì ASCE 7 Chapter 12</h1>
      <p>
        Helper for seismic design using ASCE&nbsp;7 Chapter&nbsp;12 (simplified ELF-style workflow). You still need the code
        for system selection, R, &Omega;<sub>0</sub>, C<sub>d</sub>, limits on C<sub>s</sub>, and irregularity checks.
      </p>
    </header>

    <section class="card disclaimer">
      <strong>Important ‚Äì Not a design program</strong>
      <p>
        This tool is for educational and drafting convenience only. It is <u>not</u> project-specific engineering,
        does not create an Engineer-of-Record or client relationship, and is not a substitute for design, review,
        or code compliance checks by a licensed Professional Engineer familiar with the project, jurisdiction,
        and applicable codes.
      </p>
      <p>
        The Structural Engineering Podcast, its hosts, guests, and contributors assume no responsibility for the
        completeness, correctness, or application of any values produced here. By using this helper you agree you
        are solely responsible for verifying all inputs, formulas, and results against ASCE&nbsp;7, the IBC, and any
        local amendments.
      </p>
    </section>

    <!-- 1: PROJECT & CODE -->
    <section class="card">
      <h2>1. Project &amp; Code</h2>
      <p class="sub">Basic identifiers plus governing code and risk category.</p>
      <div class="grid">
        <div class="field">
          <label for="projName">Project name</label>
          <input id="projName" type="text" placeholder="Tomlinson House" />
        </div>
        <div class="field">
          <label for="projNumber">Project number</label>
          <input id="projNumber" type="text" placeholder="P-2025-001" />
        </div>
        <div class="field">
          <label for="codeYear">Building code</label>
          <input id="codeYear" type="text" placeholder="IBC 2018, local amendments" />
        </div>
        <div class="field">
          <label for="asceEdition">ASCE 7 edition</label>
          <select id="asceEdition">
            <option value="">(select)</option>
            <option value="ASCE 7-10">ASCE 7-10</option>
            <option value="ASCE 7-16">ASCE 7-16</option>
            <option value="ASCE 7-22">ASCE 7-22</option>
          </select>
        </div>
        <div class="field">
          <label for="riskCat">Risk category</label>
          <select id="riskCat">
            <option value="">(select)</option>
            <option value="I">I</option>
            <option value="II">II</option>
            <option value="III">III</option>
            <option value="IV">IV</option>
          </select>
        </div>
        <div class="field">
          <label for="sdc">Seismic Design Category (SDC)</label>
          <input id="sdc" type="text" placeholder="e.g. Dmax, C, etc." />
        </div>
      </div>
    </section>

    <!-- 2: SITE PARAMETERS & RESPONSE -->
    <section class="card">
      <h2>2. Site parameters &amp; response</h2>
      <p class="sub">
        Enter site class and spectral response accelerations (mapped and design). Values are typically obtained from
        USGS tools and ASCE&nbsp;7 site coefficients.
      </p>
      <div class="grid">
        <div class="field">
          <label for="siteClass">Site class</label>
          <input id="siteClass" type="text" placeholder="e.g. Site Class D" />
        </div>
        <div class="field">
          <label for="Ss">Mapped short-period spectral accel., S<sub>s</sub> (g)</label>
          <input id="Ss" type="number" step="0.01" placeholder="e.g. 1.00" />
        </div>
        <div class="field">
          <label for="S1">Mapped 1-s spectral accel., S<sub>1</sub> (g)</label>
          <input id="S1" type="number" step="0.01" placeholder="e.g. 0.40" />
        </div>
        <div class="field">
          <label for="Sds">Design spectral accel., S<sub>DS</sub> (g)</label>
          <input id="Sds" type="number" step="0.01" placeholder="e.g. 0.67" />
        </div>
        <div class="field">
          <label for="Sd1">Design spectral accel., S<sub>D1</sub> (g)</label>
          <input id="Sd1" type="number" step="0.01" placeholder="e.g. 0.40" />
        </div>
      </div>
    </section>

    <!-- 3: SYSTEM DEFINITION (R, Œ©0, Cd) -->
    <section class="card">
      <h2>3. Seismic-force-resisting system</h2>
      <p class="sub">
        Define the actual system from ASCE&nbsp;7 Chapter&nbsp;12 tables (material, frame/braced/shearwall, special/ordinary, etc.).
        Enter R, &Omega;<sub>0</sub>, and C<sub>d</sub> directly from the table.
      </p>
      <div class="grid">
        <div class="field">
          <label for="sfrsDesc">System description</label>
          <input id="sfrsDesc" type="text" placeholder="e.g. Special steel moment frame" />
        </div>
        <div class="field">
          <label for="R">Response modification factor, R</label>
          <input id="R" type="number" step="0.1" placeholder="e.g. 8.0" />
        </div>
        <div class="field">
          <label for="Omega0">Overstrength factor, &Omega;<sub>0</sub></label>
          <input id="Omega0" type="number" step="0.1" placeholder="e.g. 3.0" />
        </div>
        <div class="field">
          <label for="Cd">Deflection amplification factor, C<sub>d</sub></label>
          <input id="Cd" type="number" step="0.1" placeholder="e.g. 5.5" />
        </div>
        <div class="field">
          <label for="analysisType">Analysis procedure</label>
          <select id="analysisType">
            <option value="">(select)</option>
            <option value="Equivalent Lateral Force">Equivalent Lateral Force (ELF)</option>
            <option value="Modal Response Spectrum">Modal Response Spectrum</option>
            <option value="Other / special">Other / special</option>
          </select>
        </div>
        <div class="field">
          <label for="height">Building height (approx.), h<sub>n</sub> (ft)</label>
          <input id="height" type="number" step="0.1" placeholder="e.g. 45" />
        </div>
      </div>

      <div class="inline-radio" style="margin-top:0.7rem;">
        <label><input type="checkbox" id="chkRegular" /> Vertical and plan structural regularity per ASCE&nbsp;7</label>
        <label><input type="checkbox" id="chkRedundancy" /> Redundancy / configuration acceptable per ASCE&nbsp;7</label>
        <label><input type="checkbox" id="chkDiaphragm" /> Diaphragms reasonably rigid and well tied</label>
      </div>
    </section>

    <!-- 4: BASE SHEAR & PERIOD -->
    <section class="card">
      <h2>4. Base shear &amp; key coefficients</h2>
      <p class="sub">
        Compute C<sub>s</sub> and base shear V using S<sub>DS</sub>, R, I<sub>e</sub>, and total effective seismic weight W.
        This helper uses the basic ELF form C<sub>s</sub> = S<sub>DS</sub> I<sub>e</sub> / R. You still need to check minimum and maximum
        limits on C<sub>s</sub> per ASCE&nbsp;7 (e.g., 12.8.1).
      </p>
      <div class="grid">
        <div class="field">
          <label for="Ie">Seismic importance factor, I<sub>e</sub></label>
          <input id="Ie" type="number" step="0.01" placeholder="e.g. 1.0 or 1.25" />
        </div>
        <div class="field">
          <label for="Wtotal">Total effective seismic weight, W (kips)</label>
          <input id="Wtotal" type="number" step="0.1" placeholder="e.g. 1500" />
        </div>
        <div class="field">
          <label for="CsUser">Design C<sub>s</sub> (optional override)</label>
          <input id="CsUser" type="number" step="0.001" placeholder="leave blank to use Sds¬∑Ie/R" />
        </div>
        <div class="field">
          <label for="periodT">Period used for design, T (sec)</label>
          <input id="periodT" type="number" step="0.01" placeholder="e.g. 0.70" />
        </div>
      </div>

      <div class="button-row">
        <button class="primary" type="button" id="btnCalc">‚öôÔ∏è Compute C<sub>s</sub>, V, and text</button>
        <button class="secondary" type="button" id="btnCopy">üìã Copy calc report</button>
      </div>
    </section>

    <!-- OUTPUT: CALC REPORT -->
    <section class="card">
      <h2>5. Seismic design summary (calc report)</h2>
      <p class="sub">
        Report text suitable for pasting into a calc package. Edit as needed and verify against ASCE&nbsp;7.
      </p>
      <textarea id="report" readonly></textarea>
      <div id="copyStatus" class="copy-status" aria-live="polite"></div>
    </section>

    <!-- OUTPUT: GENERAL NOTES SNIPPET -->
    <section class="card">
      <h2>6. General notes snippet (seismic criteria)</h2>
      <p class="sub">
        Short text block for structural general notes. Copy and paste into your drawings or the Notes Hub and edit as required.
      </p>
      <textarea id="notes" readonly></textarea>
      <div class="button-row">
        <button class="secondary" type="button" id="btnCopyNotes">üìã Copy notes snippet</button>
      </div>
    </section>

    <footer>
      Seismic Helper ‚Äì ASCE&nbsp;7 Chapter&nbsp;12; verify all values and limits against the code and local requirements.
    </footer>
  </div>

  <script>
    function num(id) {
      var v = parseFloat(document.getElementById(id).value);
      return isNaN(v) ? null : v;
    }

    function str(id) {
      return (document.getElementById(id).value || "").trim();
    }

    function fmt(x, digits) {
      if (x === null || x === undefined || isNaN(x)) return "N/A";
      return x.toFixed(digits != null ? digits : 3);
    }

    function buildReport() {
      var rep = [];

      var projName   = str("projName");
      var projNumber = str("projNumber");
      var codeYear   = str("codeYear");
      var asceEd     = str("asceEdition");
      var riskCat    = str("riskCat");
      var sdc        = str("sdc");

      rep.push("SEISMIC DESIGN SUMMARY ‚Äì ASCE 7 CHAPTER 12 (SIMPLIFIED ELF-STYLE)");
      rep.push("");

      rep.push("PROJECT & CODE");
      rep.push("--------------");
      if (projName)   rep.push("Project: " + projName);
      if (projNumber) rep.push("Project No.: " + projNumber);
      if (codeYear)   rep.push("Governing building code: " + codeYear);
      if (asceEd)     rep.push("Seismic standard: " + asceEd);
      if (riskCat)    rep.push("Risk Category: " + riskCat);
      if (sdc)        rep.push("Seismic Design Category (SDC): " + sdc);
      rep.push("");

      // Site & spectra
      var siteClass = str("siteClass");
      var Ss        = num("Ss");
      var S1        = num("S1");
      var Sds       = num("Sds");
      var Sd1       = num("Sd1");

      rep.push("SITE PARAMETERS & RESPONSE");
      rep.push("--------------------------");
      if (siteClass) rep.push("Site Class: " + siteClass);
      rep.push("Mapped spectral accelerations:");
      rep.push("  S_s  = " + (Ss !== null ? fmt(Ss, 3) + " g" : "_____ g"));
      rep.push("  S_1  = " + (S1 !== null ? fmt(S1, 3) + " g" : "_____ g"));
      rep.push("Design spectral accelerations (user to confirm per ASCE 7 Ch. 11):");
      rep.push("  S_DS = " + (Sds !== null ? fmt(Sds, 3) + " g" : "_____ g"));
      rep.push("  S_D1 = " + (Sd1 !== null ? fmt(Sd1, 3) + " g" : "_____ g"));
      rep.push("");

      // System
      var sfrsDesc   = str("sfrsDesc");
      var R          = num("R");
      var Omega0     = num("Omega0");
      var Cd         = num("Cd");
      var analysis   = str("analysisType");
      var height     = num("height");
      var chkRegular = document.getElementById("chkRegular").checked;
      var chkRedund  = document.getElementById("chkRedundancy").checked;
      var chkDia     = document.getElementById("chkDiaphragm").checked;

      rep.push("SEISMIC-FORCE-RESISTING SYSTEM");
      rep.push("--------------------------------");
      if (sfrsDesc) rep.push("System: " + sfrsDesc);
      if (R !== null)      rep.push("Response modification factor, R = " + fmt(R, 2));
      if (Omega0 !== null) rep.push("Overstrength factor, Œ©0 = " + fmt(Omega0, 2));
      if (Cd !== null)     rep.push("Deflection amplification factor, Cd = " + fmt(Cd, 2));
      if (analysis)        rep.push("Analysis procedure: " + analysis);
      if (height !== null) rep.push("Approximate building height h_n ‚âà " + fmt(height, 1) + " ft");
      rep.push("");
      rep.push("Regularity / configuration checklist (user to verify against ASCE 7):");
      rep.push("  - Vertical & plan structural regularity: " + (chkRegular ? "YES" : "NO / NOT CHECKED"));
      rep.push("  - Redundancy / configuration acceptable: " + (chkRedund  ? "YES" : "NO / NOT CHECKED"));
      rep.push("  - Diaphragms reasonably rigid and well tied: " + (chkDia ? "YES" : "NO / NOT CHECKED"));
      rep.push("");

      // Base shear
      var Ie      = num("Ie");
      var Wtotal  = num("Wtotal");
      var CsUser  = num("CsUser");
      var T       = num("periodT");

      var Cs_basic = null;
      if (Sds !== null && R !== null && Ie !== null && R !== 0) {
        Cs_basic = Sds * Ie / R;
      }

      var Cs_final = null;
      if (CsUser !== null) {
        Cs_final = CsUser;
      } else if (Cs_basic !== null) {
        Cs_final = Cs_basic;
      }

      rep.push("BASE SHEAR COEFFICIENT & PERIOD");
      rep.push("--------------------------------");
      if (Ie !== null) {
        rep.push("Seismic importance factor: Ie = " + fmt(Ie, 2));
      } else {
        rep.push("Seismic importance factor: Ie = ____");
      }

      if (Cs_basic !== null) {
        rep.push("");
        rep.push("Basic ELF coefficient (before min / max checks):");
        rep.push("  Cs_basic = SDS ¬∑ Ie / R");
        rep.push("           = " + fmt(Sds,3) + " ¬∑ " + fmt(Ie,2) + " / " + fmt(R,2));
        rep.push("           = " + fmt(Cs_basic, 4));
      } else {
        rep.push("");
        rep.push("Cs_basic not computed ‚Äì need S_DS, R, and I_e.");
      }

      if (CsUser !== null) {
        rep.push("");
        rep.push("User-selected design coefficient:");
        rep.push("  Cs_design (user) = " + fmt(CsUser, 4));
        rep.push("  (Use this value for V below; user to confirm it satisfies ASCE 7 min / max limits.)");
      }

      if (T !== null) {
        rep.push("");
        rep.push("Period used for design: T = " + fmt(T, 3) + " sec (user to verify vs. Ta, CuTa, and modal analysis where applicable).");
      }

      var V = null;
      if (Cs_final !== null && Wtotal !== null) {
        V = Cs_final * Wtotal;
        rep.push("");
        rep.push("Base shear:");
        rep.push("  W (effective seismic weight) = " + fmt(Wtotal, 1) + " kips");
        rep.push("  Cs_used                      = " + fmt(Cs_final, 4));
        rep.push("  V = Cs_used ¬∑ W              = " + fmt(Cs_final,4) + " ¬∑ " + fmt(Wtotal,1) + " = " + fmt(V,1) + " kips");
      } else {
        rep.push("");
        rep.push("Base shear V not computed ‚Äì need Cs (basic or user) and W.");
      }

      rep.push("");
      rep.push("NOTES & LIMITATIONS");
      rep.push("-------------------");
      rep.push("- This helper applies the basic ELF form Cs = SDS ¬∑ Ie / R only. User must check all minimum and");
      rep.push("  maximum limits on Cs in ASCE 7 (e.g., 12.8.1) and adjust Cs accordingly.");
      rep.push("- System selection, R, Œ©0, and Cd values must be taken directly from the applicable ASCE 7 tables");
      rep.push("  for the actual SFRS used (material, detailing level, frame / braced / shear wall, etc.).");
      rep.push("- Period T must be checked against approximate Ta, upper-bound limits (e.g. CuTa), and modal");
      rep.push("  procedures where required by ASCE 7 and the governing building code.");
      rep.push("- Story forces, diaphragm forces, and member checks are not performed here; user must distribute V");
      rep.push("  to the structure and design all elements per ASCE 7 and material standards.");
      rep.push("- Overstrength (Œ©0) and amplified deflections (Cd) must be applied where required by ASCE 7.");
      rep.push("- All results are for convenience only and must be verified by a licensed Professional Engineer.");

      return rep.join("\n");
    }

    function buildNotes() {
      var projName   = str("projName");
      var projNumber = str("projNumber");
      var codeYear   = str("codeYear");
      var asceEd     = str("asceEdition");
      var riskCat    = str("riskCat");
      var sdc        = str("sdc");

      var siteClass = str("siteClass");
      var Sds       = num("Sds");
      var Sd1       = num("Sd1");

      var sfrsDesc = str("sfrsDesc");
      var R        = num("R");
      var Omega0   = num("Omega0");
      var Cd       = num("Cd");

      var Ie     = num("Ie");
      var CsUser = num("CsUser");
      var Cs_line = "";
      if (CsUser !== null) {
        Cs_line = "Seismic response coefficient: Cs = " + fmt(CsUser, 3) + " (user-selected, satisfying ASCE 7 Cs limits).";
      }

      var lines = [];

      lines.push("STRUCTURAL DESIGN CRITERIA ‚Äì SEISMIC");
      lines.push("");
      if (projName)   lines.push("PROJECT: " + projName);
      if (projNumber) lines.push("PROJECT NO.: " + projNumber);
      lines.push("");

      var codeLine = "Seismic loads determined in accordance with ";
      if (codeYear) codeLine += codeYear + " ";
      if (asceEd)   codeLine += "(" + asceEd + ")";
      if (!codeYear && !asceEd) codeLine += "the governing building code and applicable ASCE 7 edition";
      codeLine += ".";
      lines.push(codeLine);

      if (riskCat) lines.push("Risk Category: " + riskCat + ".");
      if (sdc)     lines.push("Seismic Design Category (SDC): " + sdc + ".");

      if (siteClass || Sds !== null || Sd1 !== null) {
        lines.push("");
        lines.push("Seismic ground motion parameters:");
        if (siteClass) lines.push("  Site Class: " + siteClass + ".");
        if (Sds !== null) lines.push("  Design spectral acceleration: SDS = " + fmt(Sds, 3) + " g.");
        else lines.push("  Design spectral acceleration: SDS = ____ g.");
        if (Sd1 !== null) lines.push("  Design spectral acceleration: SD1 = " + fmt(Sd1, 3) + " g.");
        else lines.push("  Design spectral acceleration: SD1 = ____ g.");
      }

      if (sfrsDesc || R !== null || Omega0 !== null || Cd !== null) {
        lines.push("");
        lines.push("Seismic-force-resisting system:");
        if (sfrsDesc) lines.push("  System: " + sfrsDesc + ".");
        if (R !== null)      lines.push("  Response modification factor: R = " + fmt(R, 2) + ".");
        if (Omega0 !== null) lines.push("  Overstrength factor: Œ©0 = " + fmt(Omega0, 2) + ".");
        if (Cd !== null)     lines.push("  Deflection amplification factor: Cd = " + fmt(Cd, 2) + ".");
      }

      if (Ie !== null) {
        lines.push("");
        lines.push("Seismic importance factor: Ie = " + fmt(Ie, 2) + ".");
      }

      if (Cs_line) {
        lines.push("");
        lines.push(Cs_line);
      }

      lines.push("");
      lines.push("Seismic design, detailing, and drift checks shall conform to ASCE 7 and the applicable material standards.");

      return lines.join("\n");
    }

    function updateOutputs() {
      var text = buildReport();
      document.getElementById("report").value = text;

      var notesText = buildNotes();
      document.getElementById("notes").value = notesText;

      var status = document.getElementById("copyStatus");
      status.textContent = "";
      status.className = "copy-status";
    }

    function copyTextFrom(id, statusId) {
      var el = document.getElementById(id);
      var status = document.getElementById(statusId);
      var text = el.value || "";

      if (!text.trim()) {
        status.textContent = "Nothing to copy. Compute values first.";
        status.className = "copy-status error";
        return;
      }

      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text);
        } else {
          el.focus();
          el.select();
          document.execCommand("copy");
        }
        status.textContent = "Copied. Paste into your calc or notes and edit as needed.";
        status.className = "copy-status success";
      } catch (e) {
        status.textContent = "Could not copy automatically. Select the text and copy manually (Ctrl+C / Cmd+C).";
        status.className = "copy-status error";
      }
    }

    document.getElementById("btnCalc").addEventListener("click", updateOutputs);
    document.getElementById("btnCopy").addEventListener("click", function () {
      copyTextFrom("report", "copyStatus");
    });
    document.getElementById("btnCopyNotes").addEventListener("click", function () {
      copyTextFrom("notes", "copyStatus");
    });

    // Initial empty outputs so layout isn't blank
    updateOutputs();
  </script>
</body>
</html>
