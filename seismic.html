<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Seismic Helper â€“ ASCE 7-Style Summary</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #f5f5f7;
      --card-bg: #ffffff;
      --border: #d0d0d5;
      --accent: #1f6feb;
      --accent-soft: rgba(31, 111, 235, 0.08);
      --text-main: #111827;
      --text-muted: #4b5563;
      --danger: #b91c1c;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 14px 30px rgba(15, 23, 42, 0.08);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e5edff 0, #f5f5f7 55%);
      color: var(--text-main);
    }

    .app {
      max-width: 980px;
      margin: 0 auto;
      padding: 2.5rem 1rem 3rem;
    }

    /* Top navigation shared across tools */
    .top-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
      padding: 0.5rem 0.75rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.03);
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .top-nav a {
      font-size: 0.85rem;
      padding: 0.35rem 0.85rem;
      border-radius: 999px;
      text-decoration: none;
      color: #111827;
      background: #ffffff;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .top-nav a:hover {
      background: #e5edff;
      border-color: #1f6feb;
    }

    .top-nav a.current {
      background: #1f6feb;
      color: #ffffff;
      border-color: #1f6feb;
    }

    header {
      margin-bottom: 1.75rem;
      text-align: left;
    }

    header h1 {
      margin: 0 0 0.35rem;
      font-size: 1.9rem;
      letter-spacing: 0.03em;
    }

    header p {
      margin: 0;
      color: var(--text-muted);
      max-width: 720px;
      font-size: 0.95rem;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      padding: 1.4rem 1.5rem 1.7rem;
      margin-bottom: 1.4rem;
      border: 1px solid rgba(148,163,184,0.3);
    }

    .card h2 {
      margin: 0 0 0.7rem;
      font-size: 1.2rem;
    }

    .sub {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin: 0 0 0.6rem;
    }

    .disclaimer {
      border-left: 4px solid var(--danger);
      background: #fef2f2;
      color: #7f1d1d;
      font-size: 0.9rem;
    }

    .disclaimer strong {
      display: inline-block;
      margin-bottom: 0.25rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 0.6rem 1rem;
      margin-top: 0.4rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .field label {
      margin-bottom: 0.14rem;
      color: var(--text-muted);
    }

    .field input,
    .field select {
      padding: 0.35rem 0.45rem;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      font-size: 0.85rem;
    }

    .field input:focus,
    .field select:focus {
      outline: 2px solid var(--accent);
      outline-offset: 1px;
      background: #ffffff;
    }

    .inline-checks {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      font-size: 0.8rem;
      margin-top: 0.4rem;
      color: var(--text-muted);
    }

    .inline-checks label {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      cursor: pointer;
    }

    .warning-text {
      font-size: 0.8rem;
      color: var(--danger);
      margin-top: 0.25rem;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.65rem;
      margin-top: 0.9rem;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 0.55rem 1.15rem;
      font-size: 0.92rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      white-space: nowrap;
    }

    button.primary {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 10px 18px rgba(31,111,235,0.35);
    }

    button.secondary {
      background: #e5e7eb;
      color: #111827;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    textarea {
      width: 100%;
      min-height: 260px;
      font-family: "SF Mono", ui-monospace, Menlo, Consolas, monospace;
      font-size: 0.86rem;
      line-height: 1.5;
      padding: 0.9rem;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: #0f172a;
      color: #e5e7eb;
      box-shadow: inset 0 0 0 1px rgba(15,23,42,0.8);
      resize: vertical;
    }

    textarea:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .copy-status {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.35rem;
      min-height: 1em;
    }

    .copy-status.success { color: #059669; }
    .copy-status.error { color: var(--danger); }

    footer {
      margin-top: 1rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-align: right;
    }

    @media (max-width: 640px) {
      .app { padding-inline: 0.8rem; }
      header h1 { font-size: 1.6rem; }
      button.primary,
      button.secondary {
        flex: 1 1 auto;
        justify-content: center;
      }
      textarea {
        min-height: 220px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Shared navigation between tools -->
    <nav class="top-nav">
      <a href="index.html">General Notes</a>
      <a href="seismic.html" class="current">Seismic Helper</a>
      <a href="wind.html">Wind Helper</a>
    </nav>

    <header>
      <h1>Seismic Helper â€“ ASCE 7-Style Summary</h1>
      <p>
        Helper for basic ASCE 7 seismic design documentation: site parameters, seismic-force-resisting system,
        base shear coefficient, and notes. You still need the actual standard and commentary for real design work.
      </p>
    </header>

    <section class="card disclaimer">
      <strong>Important â€“ Not a design program</strong>
      <p>
        This tool is for educational and drafting convenience only. It is <u>not</u> project-specific engineering,
        does not create an Engineer-of-Record or client relationship, and is not a substitute for design, review,
        or code compliance checks by a licensed Professional Engineer familiar with the project, jurisdiction,
        and applicable codes.
      </p>
      <p>
        The Structural Engineering Podcast, its hosts, guests, and contributors assume no responsibility for the
        completeness, correctness, or application of any values produced here. By using this helper you agree you
        are solely responsible for verifying all inputs, formulas, and results against ASCE 7, the IBC, and any
        local amendments.
      </p>
    </section>

    <!-- 1: PROJECT & CODE -->
    <section class="card">
      <h2>1. Project &amp; code</h2>
      <p class="sub">Basic identifiers plus which ASCE 7 edition and risk category youâ€™re using.</p>
      <div class="grid">
        <div class="field">
          <label for="projName">Project name</label>
          <input id="projName" type="text" placeholder="e.g. Tomlinson House" />
        </div>
        <div class="field">
          <label for="projNumber">Project number</label>
          <input id="projNumber" type="text" placeholder="e.g. P-2025-001" />
        </div>
        <div class="field">
          <label for="codeYear">Building code</label>
          <input id="codeYear" type="text" placeholder="e.g. IBC 2024, local amendments" />
        </div>
        <div class="field">
          <label for="asceEdition">ASCE 7 edition</label>
          <select id="asceEdition">
            <option value="">(select)</option>
            <option value="ASCE 7-10">ASCE 7-10</option>
            <option value="ASCE 7-16">ASCE 7-16</option>
            <option value="ASCE 7-22">ASCE 7-22</option>
          </select>
        </div>
        <div class="field">
          <label for="riskCat">Risk category</label>
          <select id="riskCat">
            <option value="">(select)</option>
            <option value="I">I</option>
            <option value="II">II</option>
            <option value="III">III</option>
            <option value="IV">IV</option>
          </select>
        </div>
      </div>
    </section>

    <!-- 2: SITE PARAMETERS & RESPONSE -->
    <section class="card">
      <h2>2. Site parameters &amp; response</h2>
      <p class="sub">
        Enter site class and mapped / design spectral accelerations. Values are typically obtained from a seismic
        hazard tool or geotech report.
      </p>
      <div class="grid">
        <div class="field">
          <label for="siteClass">Site class</label>
          <select id="siteClass">
            <option value="">(select)</option>
            <option value="Site Class A">Site Class A â€“ Hard rock</option>
            <option value="Site Class B">Site Class B â€“ Rock</option>
            <option value="Site Class C">Site Class C â€“ Very dense soil / soft rock</option>
            <option value="Site Class D">Site Class D â€“ Stiff soil profile</option>
            <option value="Site Class E">Site Class E â€“ Soft clay soil</option>
            <option value="Site Class F">Site Class F â€“ Site-specific evaluation required</option>
          </select>
        </div>
        <div class="field">
          <label for="Ss">Mapped short-period spectral accel., S<sub>s</sub> (g)</label>
          <input id="Ss" type="number" step="0.01" placeholder="e.g. 0.75" />
        </div>
        <div class="field">
          <label for="S1">Mapped 1-s spectral accel., S<sub>1</sub> (g)</label>
          <input id="S1" type="number" step="0.01" placeholder="e.g. 0.30" />
        </div>
        <div class="field">
          <label for="Sds">Design spectral accel., S<sub>DS</sub> (g)</label>
          <input id="Sds" type="number" step="0.01" placeholder="e.g. 0.50" />
        </div>
      </div>
    </section>

    <!-- 3: SEISMIC-FORCE-RESISTING SYSTEM -->
    <section class="card">
      <h2>3. Seismic-force-resisting system</h2>
      <p class="sub">
        Define the actual system from ASCE 7 Chapter 12 tables (material, frame/braced/shear wall, special vs ordinary, etc.).
        Choosing a preset fills in R, Î©<sub>0</sub>, and C<sub>d</sub>, which you must still verify against ASCE 7.
      </p>
      <div class="grid">
        <div class="field">
          <label for="sfrsPreset">System preset (for auto-fill)</label>
          <select id="sfrsPreset">
            <option value="">(select or enter manually)</option>
            <option value="steel_smf">Steel special moment frame (SMF)</option>
            <option value="steel_imf">Steel intermediate moment frame (IMF)</option>
            <option value="steel_omf">Steel ordinary moment frame (OMF)</option>
            <option value="steel_brbf">Steel buckling-restrained braced frame (BRBF)</option>
            <option value="steel_scbf">Steel special concentrically braced frame (SCBF)</option>
            <option value="conc_smf">Reinforced concrete special moment frame</option>
            <option value="conc_omf">Reinforced concrete ordinary moment frame</option>
            <option value="wood_wsp">Light-frame wood shear walls with wood structural panels</option>
            <option value="masonry_special">Special reinforced masonry shear walls</option>
            <option value="masonry_ordinary">Ordinary reinforced masonry shear walls</option>
          </select>
        </div>

        <div class="field">
          <label for="sfrsDesc">System description</label>
          <input id="sfrsDesc" type="text" placeholder="e.g. Special steel moment frame" />
        </div>
        <div class="field">
          <label for="R">Response modification factor, R</label>
          <input id="R" type="number" step="0.1" placeholder="e.g. 8.0" />
        </div>
        <div class="field">
          <label for="Omega0">Overstrength factor, &Omega;<sub>0</sub></label>
          <input id="Omega0" type="number" step="0.1" placeholder="e.g. 3.0" />
        </div>
        <div class="field">
          <label for="Cd">Deflection amplification factor, C<sub>d</sub></label>
          <input id="Cd" type="number" step="0.1" placeholder="e.g. 5.5" />
        </div>
        <div class="field">
          <label for="analysisType">Analysis procedure</label>
          <select id="analysisType">
            <option value="">(select)</option>
            <option value="ELF">Equivalent Lateral Force (ELF)</option>
            <option value="Modal">Modal response spectrum</option>
            <option value="Linear">Linear response history</option>
            <option value="Nonlinear">Nonlinear response history</option>
          </select>
        </div>
        <div class="field">
          <label for="height">Building height (approx.), h<sub>n</sub> (ft)</label>
          <input id="height" type="number" step="1" placeholder="e.g. 45" />
        </div>
      </div>

      <div class="inline-checks">
        <label><input type="checkbox" id="chkRegular" /> Vertical and plan structural regularity per ASCE 7</label>
        <label><input type="checkbox" id="chkRedundant" /> Redundancy / configuration acceptable per ASCE 7</label>
      </div>
    </section>

    <!-- 4: BASE SHEAR & KEY COEFFICIENTS -->
    <section class="card">
      <h2>4. Base shear &amp; key coefficients</h2>
      <p class="sub">
        Approximate base shear coefficient C<sub>s</sub> and base shear V. The user is responsible for checking
        minimum, maximum, and period-based limits in ASCE 7.
      </p>
      <div class="grid">
        <div class="field">
          <label for="Ie">Importance factor, I<sub>e</sub></label>
          <input id="Ie" type="number" step="0.01" placeholder="e.g. 1.0 or 1.25" />
        </div>
        <div class="field">
          <label for="W">Seismic weight, W (kips)</label>
          <input id="W" type="number" step="0.1" placeholder="e.g. 850" />
        </div>
        <div class="field">
          <label for="CsUser">Override C<sub>s</sub> (optional)</label>
          <input id="CsUser" type="number" step="0.001" placeholder="leave blank to use S<sub>DS</sub>I<sub>e</sub>/R" />
        </div>
      </div>
      <p class="sub">
        If C<sub>s</sub> override is blank, the helper uses C<sub>s</sub> â‰ˆ S<sub>DS</sub>I<sub>e</sub> / R. You still need to check
        ASCE 7 limits (Ct/T, 0.044S<sub>DS</sub>I<sub>e</sub>, 0.01, etc.).
      </p>

      <div class="button-row">
        <button class="primary" type="button" id="btnCalc">ðŸ’¥ Compute seismic summary</button>
        <button class="secondary" type="button" id="btnCopy">ðŸ“‹ Copy calc report</button>
      </div>
    </section>

    <!-- 5: CALC REPORT -->
    <section class="card">
      <h2>5. Seismic design summary (calc report)</h2>
      <p class="sub">
        Report text suitable for pasting into a calc package. Edit as needed and verify against ASCE 7.
      </p>
      <textarea id="report" readonly></textarea>
      <div id="copyStatus" class="copy-status" aria-live="polite"></div>
    </section>

    <!-- 6: GENERAL NOTES SNIPPET -->
    <section class="card">
      <h2>6. General notes snippet (seismic criteria)</h2>
      <p class="sub">
        Short text block for structural general notes. Copy and paste into your drawings or GSN tool and edit as required.
      </p>
      <textarea id="notes" readonly></textarea>
      <div class="button-row">
        <button class="secondary" type="button" id="btnCopyNotes">ðŸ“‹ Copy notes snippet</button>
      </div>
    </section>

    <footer>
      Seismic Helper â€“ summarize inputs; verify all values against ASCE 7, NEHRP, and local code.
    </footer>
  </div>

  <script>
    // --- helpers ---
    function num(id) {
      var el = document.getElementById(id);
      if (!el) return null;
      var v = parseFloat(el.value);
      return isNaN(v) ? null : v;
    }

    function str(id) {
      var el = document.getElementById(id);
      if (!el) return "";
      return (el.value || "").trim();
    }

    function fmt(x, digits) {
      if (x === null || x === undefined || isNaN(x)) return "N/A";
      return x.toFixed(digits != null ? digits : 3);
    }

    // --- system presets (approximate; user must verify against ASCE 7) ---
    var SYSTEM_PRESETS = {
      steel_smf: {
        desc: "Steel special moment frame (SMF)",
        R: 8.0,
        Omega0: 3.0,
        Cd: 5.5
      },
      steel_imf: {
        desc: "Steel intermediate moment frame (IMF)",
        R: 4.5,
        Omega0: 3.0,
        Cd: 4.0
      },
      steel_omf: {
        desc: "Steel ordinary moment frame (OMF)",
        R: 3.5,
        Omega0: 3.0,
        Cd: 2.5
      },
      steel_brbf: {
        desc: "Steel buckling-restrained braced frame (BRBF)",
        R: 8.0,
        Omega0: 2.5,
        Cd: 5.0
      },
      steel_scbf: {
        desc: "Steel special concentrically braced frame (SCBF)",
        R: 6.0,
        Omega0: 2.0,
        Cd: 5.0
      },
      conc_smf: {
        desc: "Reinforced concrete special moment frame",
        R: 8.0,
        Omega0: 3.0,
        Cd: 5.5
      },
      conc_omf: {
        desc: "Reinforced concrete ordinary moment frame",
        R: 3.0,
        Omega0: 3.0,
        Cd: 2.5
      },
      wood_wsp: {
        desc: "Light-frame wood shear walls with wood structural panels",
        R: 6.5,
        Omega0: 3.0,
        Cd: 4.0
      },
      masonry_special: {
        desc: "Special reinforced masonry shear walls",
        R: 5.0,
        Omega0: 2.5,
        Cd: 4.0
      },
      masonry_ordinary: {
        desc: "Ordinary reinforced masonry shear walls",
        R: 3.0,
        Omega0: 2.5,
        Cd: 2.5
      }
    };

    function applySystemPreset(key) {
      var preset = SYSTEM_PRESETS[key];
      if (!preset) return;
      var descEl = document.getElementById("sfrsDesc");
      var rEl = document.getElementById("R");
      var oEl = document.getElementById("Omega0");
      var cdEl = document.getElementById("Cd");

      if (descEl && !descEl.value) descEl.value = preset.desc;
      if (rEl) rEl.value = preset.R;
      if (oEl) oEl.value = preset.Omega0;
      if (cdEl) cdEl.value = preset.Cd;
    }

    // --- core builders ---
    function buildReport() {
      var rep = [];

      var projName   = str("projName");
      var projNumber = str("projNumber");
      var codeYear   = str("codeYear");
      var asceEd     = str("asceEdition");
      var riskCat    = str("riskCat");

      rep.push("SEISMIC DESIGN SUMMARY");
      rep.push("");

      rep.push("PROJECT & CODE");
      rep.push("--------------");
      if (projName)   rep.push("Project: " + projName);
      if (projNumber) rep.push("Project No.: " + projNumber);
      if (codeYear)   rep.push("Governing building code: " + codeYear);
      if (asceEd)     rep.push("Seismic standard: " + asceEd);
      if (riskCat)    rep.push("Risk category (for SDS, S1 maps): " + riskCat);
      rep.push("");

      // Site parameters
      var siteClass = str("siteClass");
      var Ss  = num("Ss");
      var S1  = num("S1");
      var Sds = num("Sds");

      rep.push("SITE PARAMETERS & RESPONSE");
      rep.push("--------------------------");
      rep.push("Site class: " + (siteClass || "________"));
      rep.push("Mapped short-period spectral accel., Ss: " + (Ss !== null ? fmt(Ss,3) + " g" : "____ g"));
      rep.push("Mapped 1-s spectral accel., S1: " + (S1 !== null ? fmt(S1,3) + " g" : "____ g"));
      rep.push("Design spectral accel., SDS: " + (Sds !== null ? fmt(Sds,3) + " g" : "____ g"));
      rep.push("");

      // System
      var sfrsDesc = str("sfrsDesc");
      var R        = num("R");
      var Omega0   = num("Omega0");
      var Cd       = num("Cd");
      var analysis = str("analysisType");
      var h_n      = num("height");

      rep.push("SEISMIC-FORCE-RESISTING SYSTEM");
      rep.push("-------------------------------");
      rep.push("System description: " + (sfrsDesc || "________"));
      rep.push("Response modification factor, R: " + (R !== null ? fmt(R,2) : "____"));
      rep.push("Overstrength factor, Î©0: " + (Omega0 !== null ? fmt(Omega0,2) : "____"));
      rep.push("Deflection amplification factor, Cd: " + (Cd !== null ? fmt(Cd,2) : "____"));
      if (analysis) rep.push("Analysis procedure: " + analysis + " (verify applicability per ASCE 7 Ch. 12).");
      if (h_n !== null) rep.push("Approximate building height, h_n: " + fmt(h_n,1) + " ft");
      rep.push("");

      var chkReg = document.getElementById("chkRegular").checked;
      var chkRed = document.getElementById("chkRedundant").checked;
      rep.push("Regularity / redundancy notes:");
      rep.push("  - Vertical and plan structural regularity per ASCE 7: " +
               (chkReg ? "YES (checked)" : "NO / NOT CHECKED"));
      rep.push("  - Redundancy / configuration acceptable per ASCE 7: " +
               (chkRed ? "YES (checked)" : "NO / NOT CHECKED"));
      rep.push("");

      // Base shear
      var Ie     = num("Ie");
      var W      = num("W");
      var CsUser = num("CsUser");
      var Cs_basic = null;
      var Cs_final = null;

      rep.push("BASE SHEAR & KEY COEFFICIENTS");
      rep.push("-----------------------------");

      if (Sds !== null && R !== null && Ie !== null && R !== 0) {
        Cs_basic = Sds * Ie / R;
        rep.push("Basic ELF coefficient (before ASCE 7 min/max checks):");
        rep.push("  Cs_basic = SDS Â· Ie / R = " +
                 fmt(Sds,3) + " Â· " + fmt(Ie,2) + " / " + fmt(R,2) +
                 " â‰ˆ " + fmt(Cs_basic,3));
      } else {
        rep.push("Cs_basic not computed â€“ need SDS, R, and Ie.");
      }

      if (CsUser !== null) {
        Cs_final = CsUser;
        rep.push("User-selected design coefficient:");
        rep.push("  Cs = " + fmt(Cs_final,3) + " (assumed to satisfy ASCE 7 min/max limits).");
      } else {
        Cs_final = Cs_basic;
        if (Cs_basic !== null) {
          rep.push("Design coefficient used (subject to user verification of limits):");
          rep.push("  Cs â‰ˆ Cs_basic = " + fmt(Cs_final,3));
        } else {
          rep.push("Design coefficient Cs not established â€“ user to calculate based on ASCE 7.");
        }
      }

      if (W !== null && Cs_final !== null) {
        var V = Cs_final * W;
        rep.push("");
        rep.push("Approximate seismic design base shear:");
        rep.push("  W (seismic weight) = " + fmt(W,1) + " kips");
        rep.push("  V = Cs Â· W = " + fmt(Cs_final,3) + " Â· " + fmt(W,1) +
                 " â‰ˆ " + fmt(V,1) + " kips");
      } else {
        rep.push("");
        rep.push("Base shear V not computed â€“ need both Cs and W.");
      }

      rep.push("");
      rep.push("NOTES & LIMITATIONS");
      rep.push("-------------------");
      rep.push("- This helper does not check detailed ASCE 7 limits on Cs (period-dependent caps,");
      rep.push("  minimums, near-fault factors, etc.). All such checks remain the responsibility");
      rep.push("  of the Engineer-of-Record.");
      rep.push("- System properties (R, Î©0, Cd) are populated from typical values; always confirm");
      rep.push("  against the governing ASCE 7 edition and the exact system description.");
      rep.push("- Base shear V reported here is for global checking / documentation only and is");
      rep.push("  not distributed to elements or diaphragms by this tool.");
      rep.push("- Local amendments, vertical/plan irregularities, and higher mode effects may");
      rep.push("  require more advanced analysis procedures.");

      return rep.join("\n");
    }

    function buildNotes() {
      var projName   = str("projName");
      var projNumber = str("projNumber");
      var codeYear   = str("codeYear");
      var asceEd     = str("asceEdition");
      var riskCat    = str("riskCat");

      var siteClass = str("siteClass");
      var Ss  = num("Ss");
      var S1  = num("S1");
      var Sds = num("Sds");

      var sfrsDesc = str("sfrsDesc");
      var R        = num("R");
      var Omega0   = num("Omega0");
      var Cd       = num("Cd");

      var Ie     = num("Ie");
      var CsUser = num("CsUser");

      var lines = [];

      lines.push("STRUCTURAL DESIGN CRITERIA â€“ SEISMIC");
      lines.push("");
      if (projName)   lines.push("PROJECT: " + projName);
      if (projNumber) lines.push("PROJECT NO.: " + projNumber);
      lines.push("");

      var codeLine = "Seismic loads determined in accordance with ";
      if (codeYear) codeLine += codeYear + " ";
      if (asceEd)   codeLine += "(" + asceEd + ")";
      if (!codeYear && !asceEd) codeLine += "the governing building code and applicable ASCE 7 edition";
      codeLine += ".";
      lines.push(codeLine);

      if (riskCat) {
        lines.push("Risk Category: " + riskCat + ".");
      }

      lines.push("");
      lines.push("Site class and spectral response parameters:");
      lines.push("  Site Class: " + (siteClass || "________") + ".");
      lines.push("  Mapped spectral accelerations: Ss = " +
                 (Ss !== null ? fmt(Ss,3) + " g" : "____ g") +
                 ", S1 = " + (S1 !== null ? fmt(S1,3) + " g" : "____ g") + ".");
      lines.push("  Design spectral acceleration: SDS = " +
                 (Sds !== null ? fmt(Sds,3) + " g" : "____ g") + ".");

      lines.push("");
      lines.push("Seismic-force-resisting system:");
      lines.push("  System: " + (sfrsDesc || "________") + ".");
      lines.push("  Response modification factor: R = " +
                 (R !== null ? fmt(R,2) : "____") + ".");
      lines.push("  Overstrength factor: Î©0 = " +
                 (Omega0 !== null ? fmt(Omega0,2) : "____") + ".");
      lines.push("  Deflection amplification factor: Cd = " +
                 (Cd !== null ? fmt(Cd,2) : "____") + ".");

      if (Ie !== null) {
        lines.push("  Seismic importance factor: Ie = " + fmt(Ie,2) + ".");
      }

      var CsLine = "";
      if (CsUser !== null) {
        CsLine = "Seismic response coefficient: Cs = " +
                 fmt(CsUser,3) +
                 " (user-selected, satisfying ASCE 7 Cs limits).";
      } else if (Sds !== null && R !== null && Ie !== null && R !== 0) {
        var Cs_basic = Sds * Ie / R;
        CsLine = "Approximate base shear coefficient (before ASCE 7 min/max checks): " +
                 "Cs â‰ˆ SDSÂ·Ie/R = " + fmt(Cs_basic,3) + ".";
      }

      if (CsLine) {
        lines.push("");
        lines.push(CsLine);
      }

      lines.push("");
      lines.push("All seismic design values and systems shall be verified by the Engineer-of-Record");
      lines.push("against the governing ASCE 7 edition, NEHRP provisions, and any local amendments.");

      return lines.join("\n");
    }

function updateOutputs() {
  var text = buildReport();
  document.getElementById("report").value = text;

  var notesText = buildNotes();
  document.getElementById("notes").value = notesText;

  // NEW: save seismic notes for the General Notes Hub
  try {
    localStorage.setItem("ts_ep_seismic_notes", notesText);
  } catch (e) {
    console.warn("Could not save seismic notes to localStorage", e);
  }

  var status = document.getElementById("copyStatus");
  status.textContent = "";
  status.className = "copy-status";
}

    }

    function copyTextFrom(id, statusId) {
      var el = document.getElementById(id);
      var status = document.getElementById(statusId);
      var text = el.value || "";

      if (!text.trim()) {
        status.textContent = "Nothing to copy. Compute values first.";
        status.className = "copy-status error";
        return;
      }

      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text);
        } else {
          el.focus();
          el.select();
          document.execCommand("copy");
        }
        status.textContent = "Copied. Paste into your calc or notes and edit as needed.";
        status.className = "copy-status success";
      } catch (e) {
        status.textContent = "Could not copy automatically. Select the text and copy manually (Ctrl+C / Cmd+C).";
        status.className = "copy-status error";
      }
    }

    // --- event hooks ---
    document.getElementById("btnCalc").addEventListener("click", updateOutputs);
    document.getElementById("btnCopy").addEventListener("click", function () {
      copyTextFrom("report", "copyStatus");
    });
    document.getElementById("btnCopyNotes").addEventListener("click", function () {
      copyTextFrom("notes", "copyStatus");
    });
    document.getElementById("sfrsPreset").addEventListener("change", function () {
      applySystemPreset(this.value);
      updateOutputs();
    });

    // initial empty outputs so layout isn't blank
    updateOutputs();
  </script>
</body>
</html>
